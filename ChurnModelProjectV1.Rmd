---
title: "R Mid-term Project : Churn Model EDA"
author: "SNM Analytics"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

# 1.Introduction

Banks want to keep as many active clients as possible. Consequently, businesses want to know if their clients' demands are being satisfied or whether they'd like to quit the organisation. If a bank thinks that a client is considering switching to another organization, the bank might take steps to persuade the client to stay.


![**Should I Stay or Should I Leave**](E:\Classes\Data Science\Mid-Term Project\Churn Model\Customer-Churn.png)


The aim of this EDA is to find 'How does the distribution of credit score vary between customers who have churned and customers who have not churned, for customers with a balance greater than zero'. We are using dataset of bank clients from https://www.kaggle.com/ (@shubh0799).

### 1.1 More information

A continuous variable, credit score allows us to calculate its mean, median, mode, standard deviation, and range for both groups. To see how credit scores are distributed, we may also generate histograms or density graphs. As the dataset contains data on customer demographics, transactions, and behaviors, we can quickly determine each customer's credit score and churn status. Moreover, the dataset may be filtered to only show clients that have balances that are larger than zero.

# 2.Churn Model Dataset

### 2.1 Importing libraries


**Import the required libraries into R.**

```{r, results='markup', warning=FALSE}
library(ezids)
library(dplyr)
library(tidyverse)
library(readr)
library(ggplot2)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
```
### 2.2 Importing uncleaned dataset


**Import the data into R.**

```{r, results='markup'}

data <- read_csv("E:/Classes/Data Science/Mid-Term Project/Churn Model/Data.csv")

```

There are **`r length(data)`** columns and every column in the dataset contains **`r nrow(data)`** data points.

# 3.Exploratory Data Analysis


**We perform Exploratory Data Analysis or EDA to:**

1.Understand dataset variables


2.Cleaning dataset 


3.Basic statistics

  + mean, s.d., median, range


4.Simple correlations and tests

  + correlation matrix if applicable
  + z-test, t-test, anova test if applicable


5.Normality

  + QQ-plot, boxplot, histogram

### 3.1 Understand dataset variables

```{r}
head(data, n = 5)
ezids::xkablesummary(data)
```

VARIABLES | DESCRIPTION
:-: | :-:
Rownumber | Unique ID for every row
CustomerID | Unique ID for every client
Surname | Client's surname
CreditScore | Client's credit score
Geography | Country of client's origin
Gender | Client's gender
Age | Client's age
Tenure | Number of years for which the client has been with the bank
Balance | Client's balance on account
NumOfProducts | Number of client's products
HasCrCard | Flag whether client has credit card or not
IsActiveMember | Flag whether client is active member of bank or not
EstimatedSalary | Client's annual estimated salary in euros
Exited | Target variable, flag, whether client left the bank or not

### 3.2 Cleaning dataset

```{r}
# Missing values in the dataset
cat("Missing values of RowNumber in the dataset:", sum(is.na(data$RowNumber)))
cat("\nMissing values of CustomerId in the dataset:", sum(is.na(data$CustomerId)))
cat("\nMissing values of Surname in the dataset:", sum(is.na(data$Surname)))
cat("\nMissing values of CreditScore in the dataset:", sum(is.na(data$CreditScore)))
cat("\nMissing values of Geography in the dataset:", sum(is.na(data$Geography)))
cat("\nMissing values of Gender in the dataset:", sum(is.na(data$Gender)))
cat("\nMissing values of Age in the dataset:", sum(is.na(data$Age)))
cat("\nMissing values of Tenure in the dataset:", sum(is.na(data$Tenure)))
cat("\nMissing values of Balance in the dataset:", sum(is.na(data$Balance)))
cat("\nMissing values of NumOfProducts in the dataset:", sum(is.na(data$NumOfProducts)))
cat("\nMissing values of HasCrCard in the dataset:", sum(is.na(data$HasCrCard)))
cat("\nMissing values of IsActiveMember in the dataset:", sum(is.na(data$IsActiveMember)))
cat("\nMissing values of EstimatedSalary in the dataset:", sum(is.na(data$EstimatedSalary)))
cat("\nMissing values of Exited in the dataset:", sum(is.na(data$Exited)))
```

```{r}
# Aligning the data according to the variable 'balance', 'excited' and 'Geography'
churn_data_filtered <- data %>%
  filter(data$Balance > 0)

```


```{r}
churn_data_grouped <- churn_data_filtered %>%
  group_by(Exited, Geography, CreditScore) %>%
  summarize(Count = n(), .groups = "drop")

```

```{r}
ggplot(churn_data_grouped, aes(x = CreditScore, y = Count, fill = Geography)) +
  geom_bar(stat = "identity", position = "stack") +
  facet_wrap(~ Exited) +
  labs(x = "Credit Score", y = "Count", fill = "Geography")
```














